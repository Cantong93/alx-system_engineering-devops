loops and conditions parsing here
